# ========================================
# Matomo Apache Security Configuration
# configs/apache/matomo-security.conf
# ========================================
# Blockiert Zugriff auf private Verzeichnisse

<Directory /var/www/html/tmp>
    Require all denied
</Directory>

<Directory /var/www/html/config>
    Require all denied
</Directory>

<Directory /var/www/html/lang>
    Require all denied
</Directory>

# Explizit config.ini.php schützen
<Files "config.ini.php">
    Require all denied
</Files>

# Vendor-Verzeichnis schützen
<Directory /var/www/html/vendor>
    Require all denied
</Directory>

# .git Verzeichnis schützen (falls vorhanden)
<DirectoryMatch "^/var/www/html/.*\.git">
    Require all denied
</DirectoryMatch>

# Backup-Dateien schützen
<FilesMatch "\.(bak|backup|old|sql|gz|tar)$">
    Require all denied
</FilesMatch>

# ========================================
# Zusätzliche Sicherheitsheader (falls nicht von Traefik gesetzt)
# ========================================
<IfModule mod_headers.c>
    # Verhindere Information Disclosure
    Header always unset X-Powered-By
    Header unset X-Powered-By
</IfModule>
